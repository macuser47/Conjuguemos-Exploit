/*$(document).ready( function() {
    $("body").append("<p>HIIIIIIIIIIIIIIIIIIIIiIIIIIIIIIIIIIIIIIi</p>");
    var trollface = chrome.extension.getURL("gfx/troll.png");
    $("*").each( function(index, item) {
        //if ($(item).css("alt") === "Google") {
            $(this).attr('src', trollface);
        //}
    })
});*/


$(document).ready(function() {
  // Trollface image must be at 'my_extension/images/trollface.jpg'.
  var trollface = chrome.extension.getURL("gfx/troll.png");
  $('img').each(function(index, image){
    $(image).attr('src', trollface);
  });
  
  $('p, h1, h2, h3, h4, h5, h6, li, code, var, abbr, button, a').each(function(index, theP) {
    //if($(theP).hasChildNodes() === false) {
    var len = $(theP).text().length;
    len -= 2;
    var trollString = "Tr";
    for (var i = 0; i<= len; i++)
    {
      if ((i % 2) === 0 || i === len)
        trollString += "o";
      else
        trollString += "l";
    }
    if (len > 2)
        $(theP).text(trollString);
    else
        $(theP).text(" ");
    //}
  });
  
  /*setTimeout(function() {
    $('img').each(function(index, image){
        $(image).attr('src', trollface);
    });
  }, 2000);*/
  
  window.onscroll = function (e) {
    $('img').each(function(index, image){
        $(image).attr('src', trollface);
    });
    
    $('p, h1, h2, h3, h4, h5, h6, li, code, var, abbr, button, a').each(function(index, theP) {
    //if($(theP).hasChildNodes() ===  true) {
    var len = $(theP).text().length;
    len -= 2; 
    var trollString = "Tr";
    for (var i = 0; i < len; i++)
    {
      if ((i % 2) === 0 || i === (len - 1))
        trollString += "o";
      else
        trollString += "l";
    }
    if (len > 2)
        $(theP).text(trollString);
    else
        $(theP).text(" ");
    //}
  });
  }
});
